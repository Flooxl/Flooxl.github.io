<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–Ω–µ—Ü —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è: –ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: #333;
        }

        .game-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 900px;
            width: 95%;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.3);
            height: 8px;
            border-radius: 10px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress-fill {
            background: #4CAF50;
            height: 100%;
            transition: width 0.5s ease;
        }

        .stage-info {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .content {
            padding: 30px;
        }

        .intro-screen, .stage-screen, .report-screen {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .intro-text {
            font-size: 1.1em;
            line-height: 1.8;
            margin-bottom: 25px;
            color: #555;
        }

        .stage-title {
            font-size: 1.6em;
            color: #667eea;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stage-description {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #667eea;
        }

        .task-list {
            list-style: none;
            margin-bottom: 25px;
        }

        .task-item {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .task-item:hover {
            border-color: #667eea;
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .task-item.completed {
            border-color: #4CAF50;
            background: #f1f8f4;
        }

        .task-item.error {
            border-color: #f44336;
            background: #ffebee;
        }

        .task-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #ccc;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .task-item.completed .task-checkbox {
            background: #4CAF50;
            border-color: #4CAF50;
            color: white;
        }

        .task-item.error .task-checkbox {
            background: #f44336;
            border-color: #f44336;
            color: white;
        }

        .email-list {
            margin-bottom: 25px;
        }

        .email-item {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .email-item:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .email-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .email-subject {
            color: #333;
            font-size: 1.1em;
        }

        .email-sender {
            color: #666;
            font-size: 0.9em;
        }

        .email-body {
            color: #555;
            line-height: 1.6;
            margin-top: 10px;
        }

        .email-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #4CAF50;
            color: white;
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .device-panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .device-item {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .device-info {
            flex: 1;
        }

        .device-name {
            font-weight: bold;
            color: #333;
        }

        .device-details {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }

        .device-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-safe {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .status-suspicious {
            background: #fff3e0;
            color: #f57c00;
        }

        .status-dangerous {
            background: #ffebee;
            color: #c62828;
        }

        .cloud-files {
            margin-bottom: 20px;
        }

        .file-item {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .file-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .file-name {
            font-weight: bold;
            color: #333;
        }

        .file-sharing {
            font-size: 0.9em;
            color: #666;
        }

        .sharing-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            margin-left: 5px;
        }

        .sharing-private {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .sharing-public {
            background: #ffebee;
            color: #c62828;
        }

        .sharing-team {
            background: #e3f2fd;
            color: #1565c0;
        }

        .report-screen {
            text-align: center;
        }

        .score-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            margin: 30px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            font-weight: bold;
            color: white;
            position: relative;
        }

        .score-good {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        }

        .score-medium {
            background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
        }

        .score-bad {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
        }

        .report-title {
            font-size: 2em;
            color: #667eea;
            margin-bottom: 20px;
        }

        .errors-list {
            text-align: left;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .error-item {
            padding: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #f44336;
            background: white;
        }

        .recommendations {
            text-align: left;
            background: #e3f2fd;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .recommendation-item {
            padding: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #2196F3;
            background: white;
        }

        .buttons-row {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        .password-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            margin-bottom: 15px;
        }

        .password-strength {
            height: 8px;
            border-radius: 4px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }

        .strength-weak {
            background: #f44336;
            width: 33%;
        }

        .strength-medium {
            background: #FF9800;
            width: 66%;
        }

        .strength-strong {
            background: #4CAF50;
            width: 100%;
        }

        .hint {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 12px;
            margin: 15px 0;
            font-size: 0.95em;
        }

        .timer {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            animation: modalSlide 0.3s ease;
        }

        @keyframes modalSlide {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .social-profile {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .profile-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            color: white;
        }

        .checkbox-group {
            margin: 15px 0;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            margin-bottom: 10px;
            background: white;
            border-radius: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>üîí –ö–æ–Ω–µ—Ü —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è: –ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h1>
            <div class="stage-info">
                <span id="currentStage">–≠—Ç–∞–ø: –í–≤–µ–¥–µ–Ω–∏–µ</span>
                <span class="timer" id="timer">–í—Ä–µ–º—è: 00:00</span>
                <span id="scoreDisplay">–û—á–∫–∏: 100</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
        </div>

        <div class="content" id="gameContent">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
    </div>

    <div class="modal" id="feedbackModal">
        <div class="modal-content">
            <h2 id="modalTitle">–†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
            <p id="modalText"></p>
            <button class="btn btn-primary" onclick="closeFeedbackModal()">–ü–æ–Ω—è—Ç–Ω–æ</button>
        </div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        const gameState = {
            currentStage: 0,
            score: 100,
            maxScore: 100,
            errors: [],
            startTime: Date.now(),
            stageData: {},
            completedTasks: [],
            hintsUsed: 0
        };

        // –î–∞–Ω–Ω—ã–µ —ç—Ç–∞–ø–æ–≤
        const stages = [
            {
                id: 'workspace',
                title: 'üíª –†–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ',
                icon: 'üíª',
                description: '–ü–µ—Ä–µ–¥ —É—Ö–æ–¥–æ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ—ë —Ä–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä',
                tasks: [
                    {
                        id: 'lock_pc',
                        text: '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä (Win+L)',
                        correct: true,
                        penalty: 15,
                        hint: '–ù–µ–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä = –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º'
                    },
                    {
                        id: 'updates',
                        text: '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
                        correct: true,
                        penalty: 10,
                        hint: '–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–∫—Ä—ã–≤–∞—é—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏'
                    },
                    {
                        id: 'usb_remove',
                        text: '–ò–∑–≤–ª–µ—á—å –≤—Å–µ USB-–Ω–æ—Å–∏—Ç–µ–ª–∏',
                        correct: true,
                        penalty: 12,
                        hint: 'USB –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–º –∞—Ç–∞–∫–∏'
                    },
                    {
                        id: 'monitor_off',
                        text: '–û—Å—Ç–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä –≤–∫–ª—é—á–µ–Ω–Ω—ã–º –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π',
                        correct: false,
                        penalty: 5,
                        hint: '–ú–æ–Ω–∏—Ç–æ—Ä –ª—É—á—à–µ –≤—ã–∫–ª—é—á–∏—Ç—å –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —ç–Ω–µ—Ä–≥–∏–∏'
                    },
                    {
                        id: 'antivirus',
                        text: '–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å –∞–∫—Ç–∏–≤–µ–Ω',
                        correct: true,
                        penalty: 10,
                        hint: '–ê–Ω—Ç–∏–≤–∏—Ä—É—Å - –ø–µ—Ä–≤–∞—è –ª–∏–Ω–∏—è –∑–∞—â–∏—Ç—ã'
                    }
                ]
            },
            {
                id: 'passwords',
                title: 'üîë –ü–∞—Ä–æ–ª–∏ –∏ —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏',
                icon: 'üîë',
                description: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞—à–∏—Ö —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π',
                type: 'password',
                requirements: {
                    minLength: 12,
                    hasUpperCase: true,
                    hasLowerCase: true,
                    hasNumbers: true,
                    hasSpecial: true,
                    notCommon: true
                }
            },
            {
                id: 'email',
                title: 'üìß –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞',
                icon: 'üìß',
                description: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ö–æ–¥—è—â–∏–µ –ø–∏—Å—å–º–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ñ–∏—à–∏–Ω–≥',
                emails: [
                    {
                        id: 1,
                        from: 'it-support@company-security.com',
                        subject: '–°–†–û–ß–ù–û: –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è VPN',
                        body: '–£–≤–∞–∂–∞–µ–º—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫! –í —Å–≤—è–∑–∏ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å–∏–º –≤–∞—Å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–∞—Ä–æ–ª—å, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: http://company-vpn-update.tk/verify',
                        isPhishing: true,
                        penalty: 20,
                        hints: ['–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –¥–æ–º–µ–Ω .tk', '–ó–∞–ø—Ä–æ—Å –ø–∞—Ä–æ–ª—è –ø–æ email', '–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ä–æ—á–Ω–æ—Å—Ç–∏']
                    },
                    {
                        id: 2,
                        from: 'hr@company.com',
                        subject: '–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ',
                        body: '–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –ù–∞–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ –≤ –ø—è—Ç–Ω–∏—Ü—É —Å–æ—Å—Ç–æ–∏—Ç—Å—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ. –ü—Ä–æ—Å–∏–º –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É—á–∞—Å—Ç–∏–µ –¥–æ —Å—Ä–µ–¥—ã.',
                        isPhishing: false,
                        penalty: 10,
                        hints: ['–õ–µ–≥–∏—Ç–∏–º–Ω—ã–π –¥–æ–º–µ–Ω –∫–æ–º–ø–∞–Ω–∏–∏', '–ù–æ—Ä–º–∞–ª—å–Ω—ã–π —Ç–æ–Ω –ø–∏—Å—å–º–∞']
                    },
                    {
                        id: 3,
                        from: 'colleague@company.com',
                        subject: '–î–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.exe',
                        body: '–ü—Ä–∏–≤–µ—Ç! –°–∫–∏–Ω—É–ª —Ç–µ–±–µ –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏. –û—Ç–∫—Ä–æ–π –≤–ª–æ–∂–µ–Ω–∏–µ "report.exe" –∏ –¥–∞–π —Ñ–∏–¥–±–µ–∫.',
                        isPhishing: true,
                        penalty: 25,
                        hints: ['–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª .exe', '–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –≤–ª–æ–∂–µ–Ω–∏–µ', '–ù–µ—Ç–∏–ø–∏—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å']
                    },
                    {
                        id: 4,
                        from: 'admin@company.com',
                        subject: '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
                        body: '–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞—Ä–æ–ª—è–º. –ü—Ä–æ—Å–∏–º –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –≤–æ –≤–ª–æ–∂–µ–Ω–∏–∏ (PDF).',
                        isPhishing: false,
                        penalty: 10,
                        hints: ['–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å', 'PDF –¥–æ–∫—É–º–µ–Ω—Ç', '–†–∞–±–æ—á–∞—è —Ç–µ–º–∞']
                    }
                ]
            },
            {
                id: 'network',
                title: 'üåê –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å–µ—Ç—å',
                icon: 'üåê',
                description: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å–µ—Ç–∏',
                devices: [
                    {
                        id: 1,
                        name: 'MacBook Pro - –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤',
                        mac: 'A4:5E:60:F2:3C:1A',
                        status: 'safe',
                        isLegit: true
                    },
                    {
                        id: 2,
                        name: 'iPhone 14 - –ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞',
                        mac: 'B8:27:EB:7D:2E:4F',
                        status: 'safe',
                        isLegit: true
                    },
                    {
                        id: 3,
                        name: 'Unknown Device',
                        mac: 'DC:A6:32:1F:8B:C2',
                        status: 'suspicious',
                        isLegit: false,
                        penalty: 20
                    },
                    {
                        id: 4,
                        name: 'HP Printer Office-3',
                        mac: '00:1B:44:11:3A:B7',
                        status: 'safe',
                        isLegit: true
                    },
                    {
                        id: 5,
                        name: 'Xiaomi-Redmi',
                        mac: '5C:CF:7F:A2:B1:D3',
                        status: 'suspicious',
                        isLegit: false,
                        penalty: 15
                    }
                ]
            },
            {
                id: 'cloud',
                title: '‚òÅÔ∏è –û–±–ª–∞—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã',
                icon: '‚òÅÔ∏è',
                description: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±–ª–∞—á–Ω—ã–º —Ñ–∞–π–ª–∞–º',
                files: [
                    {
                        id: 1,
                        name: '–ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç Q4 2024.xlsx',
                        sharing: 'team',
                        needsChange: false
                    },
                    {
                        id: 2,
                        name: '–ü–∞—Ä–æ–ª–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–æ–≤.txt',
                        sharing: 'public',
                        needsChange: true,
                        penalty: 30
                    },
                    {
                        id: 3,
                        name: '–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞.pptx',
                        sharing: 'private',
                        needsChange: false
                    },
                    {
                        id: 4,
                        name: '–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.csv',
                        sharing: 'public',
                        needsChange: true,
                        penalty: 35
                    },
                    {
                        id: 5,
                        name: '–§–æ—Ç–æ —Å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–∞.zip',
                        sharing: 'team',
                        needsChange: false
                    }
                ]
            },
            {
                id: 'social',
                title: 'üë• –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏',
                icon: 'üë•',
                description: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–æ—Ü—Å–µ—Ç—è—Ö',
                tasks: [
                    {
                        id: 'profile_visibility',
                        text: '–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ—Ñ–∏–ª—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–ª–ª–µ–≥',
                        correct: true,
                        penalty: 8
                    },
                    {
                        id: 'work_info',
                        text: '–£–¥–∞–ª–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö',
                        correct: true,
                        penalty: 12
                    },
                    {
                        id: 'fake_account',
                        text: '–ü—Ä–∏–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å –æ—Ç "–û—Ç–¥–µ–ª –∫–∞–¥—Ä–æ–≤ –û–û–û –ö–æ–º–ø–∞–Ω–∏—è"',
                        correct: false,
                        penalty: 15
                    },
                    {
                        id: 'notifications',
                        text: '–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤—Ö–æ–¥–µ —Å –Ω–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤',
                        correct: true,
                        penalty: 10
                    }
                ]
            }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            showIntro();
            startTimer();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –≤–≤–µ–¥–µ–Ω–∏–µ
        function showIntro() {
            const content = document.getElementById('gameContent');
            content.innerHTML = `
                <div class="intro-screen">
                    <h2 style="color: #667eea; font-size: 2em; margin-bottom: 20px;">
                        –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä –ø–æ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!
                    </h2>
                    <div class="intro-text">
                        <p style="margin-bottom: 15px;">
                            üìã <strong>–í–∞—à–∞ –∑–∞–¥–∞—á–∞:</strong> –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å, –æ–±–µ–∑–æ–ø–∞—Å–∏–≤ –≤—Å–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã.
                        </p>
                        <p style="margin-bottom: 15px;">
                            üéØ <strong>–¶–µ–ª—å:</strong> –ø—Ä–æ–π—Ç–∏ 6 —ç—Ç–∞–ø–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—à–∏–±–æ–∫.
                        </p>
                        <p style="margin-bottom: 15px;">
                            ‚ö†Ô∏è <strong>–í–Ω–∏–º–∞–Ω–∏–µ:</strong> –∫–∞–∂–¥–∞—è –æ—à–∏–±–∫–∞ —Å–Ω–∏–∂–∞–µ—Ç –≤–∞—à—É –æ—Ü–µ–Ω–∫—É –∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!
                        </p>
                        <p style="margin-bottom: 25px;">
                            üìä <strong>–û—Ü–µ–Ω–∫–∞:</strong> –≤ –∫–æ–Ω—Ü–µ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ –≤–∞—à–µ–º —É—Ä–æ–≤–Ω–µ –∫–∏–±–µ—Ä–≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏.
                        </p>
                        <div class="hint">
                            üí° <strong>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</strong> –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —á–∏—Ç–∞–π—Ç–µ –æ–ø–∏—Å–∞–Ω–∏—è –∏ –Ω–µ —Ç–æ—Ä–æ–ø–∏—Ç–µ—Å—å. –í —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ –æ–¥–Ω–∞ –æ—à–∏–±–∫–∞ –º–æ–∂–µ—Ç —Å—Ç–æ–∏—Ç—å –∫–æ–º–ø–∞–Ω–∏–∏ –º–∏–ª–ª–∏–æ–Ω—ã.
                        </div>
                    </div>
                    <div class="buttons-row">
                        <button class="btn btn-primary" onclick="startGame()">
                            üöÄ –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å
                        </button>
                    </div>
                </div>
            `;
        }

        // –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
        function startGame() {
            gameState.currentStage = 0;
            loadStage(0);
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —ç—Ç–∞–ø
        function loadStage(stageIndex) {
            if (stageIndex >= stages.length) {
                showReport();
                return;
            }

            const stage = stages[stageIndex];
            gameState.currentStage = stageIndex;
            
            updateProgress();
            document.getElementById('currentStage').textContent = `–≠—Ç–∞–ø ${stageIndex + 1}/6: ${stage.title}`;

            const content = document.getElementById('gameContent');
            
            if (stage.type === 'password') {
                renderPasswordStage(stage);
            } else if (stage.emails) {
                renderEmailStage(stage);
            } else if (stage.devices) {
                renderNetworkStage(stage);
            } else if (stage.files) {
                renderCloudStage(stage);
            } else {
                renderTaskStage(stage);
            }
        }

        // –†–µ–Ω–¥–µ—Ä —ç—Ç–∞–ø–∞ —Å –∑–∞–¥–∞—á–∞–º–∏
        function renderTaskStage(stage) {
            const content = document.getElementById('gameContent');
            content.innerHTML = `
                <div class="stage-screen">
                    <div class="stage-title">
                        <span>${stage.icon}</span>
                        <span>${stage.title}</span>
                    </div>
                    <div class="stage-description">
                        ${stage.description}
                    </div>
                    <ul class="task-list" id="taskList">
                        ${stage.tasks.map(task => `
                            <li class="task-item" data-task-id="${task.id}" onclick="toggleTask('${task.id}', ${task.correct})">
                                <div class="task-checkbox">
                                    <span class="check-mark"></span>
                                </div>
                                <div style="flex: 1;">
                                    ${task.text}
                                </div>
                            </li>
                        `).join('')}
                    </ul>
                    <div class="buttons-row">
                        <button class="btn btn-secondary" onclick="showHint()">
                            üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ (-5 –æ—á–∫–æ–≤)
                        </button>
                        <button class="btn btn-primary" onclick="completeStage()">
                            –ó–∞–≤–µ—Ä—à–∏—Ç—å —ç—Ç–∞–ø ‚Üí
                        </button>
                    </div>
                </div>
            `;
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∑–∞–¥–∞—á—É
        function toggleTask(taskId, isCorrect) {
            const taskElement = document.querySelector(`[data-task-id="${taskId}"]`);
            const stage = stages[gameState.currentStage];
            const task = stage.tasks.find(t => t.id === taskId);
            
            if (taskElement.classList.contains('completed') || taskElement.classList.contains('error')) {
                taskElement.classList.remove('completed', 'error');
                taskElement.querySelector('.check-mark').textContent = '';
                
                const index = gameState.completedTasks.indexOf(taskId);
                if (index > -1) {
                    gameState.completedTasks.splice(index, 1);
                }
            } else {
                if (isCorrect) {
                    taskElement.classList.add('completed');
                    taskElement.querySelector('.check-mark').textContent = '‚úì';
                } else {
                    taskElement.classList.add('error');
                    taskElement.querySelector('.check-mark').textContent = '‚úó';
                }
                gameState.completedTasks.push(taskId);
            }
        }

        // –†–µ–Ω–¥–µ—Ä —ç—Ç–∞–ø–∞ –ø–∞—Ä–æ–ª–µ–π
        function renderPasswordStage(stage) {
            const content = document.getElementById('gameContent');
            content.innerHTML = `
                <div class="stage-screen">
                    <div class="stage-title">
                        <span>${stage.icon}</span>
                        <span>${stage.title}</span>
                    </div>
                    <div class="stage-description">
                        ${stage.description}
                    </div>
                    <div class="hint">
                        üìã <strong>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞—Ä–æ–ª—é:</strong>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>–ú–∏–Ω–∏–º—É–º 12 —Å–∏–º–≤–æ–ª–æ–≤</li>
                            <li>–ó–∞–≥–ª–∞–≤–Ω—ã–µ –∏ —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã</li>
                            <li>–¶–∏—Ñ—Ä—ã –∏ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã (!@#$%^&*)</li>
                            <li>–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏</li>
                        </ul>
                    </div>
                    <div style="margin: 25px 0;">
                        <label style="display: block; margin-bottom: 10px; font-weight: 600;">
                            –°–æ–∑–¥–∞–π—Ç–µ –Ω–∞–¥—ë–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å:
                        </label>
                        <input type="text" 
                               id="passwordInput" 
                               class="password-input" 
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å..."
                               oninput="checkPasswordStrength()">
                        <div id="passwordStrength"></div>
                        <div id="passwordFeedback" style="font-size: 0.9em; color: #666; margin-top: 10px;"></div>
                    </div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="enable2FA">
                            <label for="enable2FA">–í–∫–ª—é—á–∏—Ç—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (2FA)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="uniquePassword">
                            <label for="uniquePassword">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é, —á—Ç–æ –ø–∞—Ä–æ–ª—å —É–Ω–∏–∫–∞–ª–µ–Ω –∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ –¥—Ä—É–≥–∏—Ö —Å–∞–π—Ç–∞—Ö</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="noSavePassword">
                            <label for="noSavePassword">–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ</label>
                        </div>
                    </div>
                    <div class="buttons-row">
                        <button class="btn btn-primary" onclick="validatePassword()">
                            –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí
                        </button>
                    </div>
                </div>
            `;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–ª—ã –ø–∞—Ä–æ–ª—è
        function checkPasswordStrength() {
            const password = document.getElementById('passwordInput').value;
            const strengthDiv = document.getElementById('passwordStrength');
            const feedbackDiv = document.getElementById('passwordFeedback');
            
            let strength = 0;
            let feedback = [];

            if (password.length >= 12) strength++;
            else feedback.push('–ú–∏–Ω–∏–º—É–º 12 —Å–∏–º–≤–æ–ª–æ–≤');

            if (/[A-Z]/.test(password)) strength++;
            else feedback.push('–î–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã');

            if (/[a-z]/.test(password)) strength++;
            else feedback.push('–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã');

            if (/[0-9]/.test(password)) strength++;
            else feedback.push('–î–æ–±–∞–≤—å—Ç–µ —Ü–∏—Ñ—Ä—ã');

            if (/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password)) strength++;
            else feedback.push('–î–æ–±–∞–≤—å—Ç–µ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã');

            const commonPasswords = ['password', '123456', 'qwerty', 'admin', 'letmein'];
            if (commonPasswords.some(cp => password.toLowerCase().includes(cp))) {
                strength = 0;
                feedback = ['–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å!'];
            }

            strengthDiv.className = 'password-strength';
            feedbackDiv.textContent = feedback.join(', ');

            if (strength <= 2) {
                strengthDiv.classList.add('strength-weak');
                feedbackDiv.style.color = '#f44336';
            } else if (strength <= 4) {
                strengthDiv.classList.add('strength-medium');
                feedbackDiv.style.color = '#FF9800';
            } else {
                strengthDiv.classList.add('strength-strong');
                feedbackDiv.style.color = '#4CAF50';
                feedbackDiv.textContent = '‚úì –ù–∞–¥—ë–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å';
            }

            gameState.stageData.passwordStrength = strength;
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è
        function validatePassword() {
            const password = document.getElementById('passwordInput').value;
            const enable2FA = document.getElementById('enable2FA').checked;
            const uniquePassword = document.getElementById('uniquePassword').checked;
            const noSavePassword = document.getElementById('noSavePassword').checked;

            let errors = 0;
            let messages = [];

            if (!password || gameState.stageData.passwordStrength < 5) {
                errors++;
                messages.push('–ü–∞—Ä–æ–ª—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–¥—ë–∂–Ω—ã–π');
                gameState.score -= 15;
                gameState.errors.push({
                    stage: '–ü–∞—Ä–æ–ª–∏ –∏ —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏',
                    error: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å–ª–∞–±—ã–π –ø–∞—Ä–æ–ª—å',
                    penalty: 15
                });
            }

            if (!enable2FA) {
                errors++;
                messages.push('–ù–µ –≤–∫–ª—é—á–µ–Ω–∞ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è');
                gameState.score -= 10;
                gameState.errors.push({
                    stage: '–ü–∞—Ä–æ–ª–∏ –∏ —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏',
                    error: '–ù–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ 2FA',
                    penalty: 10
                });
            }

            if (!uniquePassword) {
                errors++;
                messages.push('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å');
                gameState.score -= 8;
                gameState.errors.push({
                    stage: '–ü–∞—Ä–æ–ª–∏ –∏ —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏',
                    error: '–ü–∞—Ä–æ–ª—å –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥–∏—Ö —Å–∞–π—Ç–∞—Ö',
                    penalty: 8
                });
            }

            if (!noSavePassword) {
                errors++;
                messages.push('–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ');
                gameState.score -= 5;
                gameState.errors.push({
                    stage: '–ü–∞—Ä–æ–ª–∏ –∏ —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏',
                    error: '–ü–∞—Ä–æ–ª—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ',
                    penalty: 5
                });
            }

            if (errors > 0) {
                showFeedback('‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã', messages.join('<br>'), false);
            } else {
                showFeedback('‚úì –û—Ç–ª–∏—á–Ω–æ!', '–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ', true);
            }

            updateScore();
            setTimeout(() => {
                loadStage(gameState.currentStage + 1);
            }, 2000);
        }

        // –†–µ–Ω–¥–µ—Ä —ç—Ç–∞–ø–∞ email
        function renderEmailStage(stage) {
            const content = document.getElementById('gameContent');
            content.innerHTML = `
                <div class="stage-screen">
                    <div class="stage-title">
                        <span>${stage.icon}</span>
                        <span>${stage.title}</span>
                    </div>
                    <div class="stage-description">
                        ${stage.description}
                    </div>
                    <div class="hint">
                        ‚ö†Ô∏è <strong>–ü—Ä–∏–∑–Ω–∞–∫–∏ —Ñ–∏—à–∏–Ω–≥–∞:</strong> –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å, —Å—Ä–æ—á–Ω–æ—Å—Ç—å, –∑–∞–ø—Ä–æ—Å –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, 
                        —Å—Ç—Ä–∞–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏, –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã (.exe), –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
                    </div>
                    <div class="email-list" id="emailList">
                        ${stage.emails.map(email => `
                            <div class="email-item" data-email-id="${email.id}">
                                <div class="email-header">
                                    <div>
                                        <div class="email-subject">${email.subject}</div>
                                        <div class="email-sender">–û—Ç: ${email.from}</div>
                                    </div>
                                </div>
                                <div class="email-body">${email.body}</div>
                                <div class="email-actions">
                                    <button class="btn btn-success" onclick="markEmail(${email.id}, false)">
                                        ‚úì –õ–µ–≥–∏—Ç–∏–º–Ω–æ–µ
                                    </button>
                                    <button class="btn btn-danger" onclick="markEmail(${email.id}, true)">
                                        ‚ö†Ô∏è –§–∏—à–∏–Ω–≥
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // –û—Ç–º–µ—Ç–∏—Ç—å email
        let emailsChecked = 0;
        function markEmail(emailId, markedAsPhishing) {
            const stage = stages[gameState.currentStage];
            const email = stage.emails.find(e => e.id === emailId);
            const emailElement = document.querySelector(`[data-email-id="${emailId}"]`);
            
            emailElement.style.opacity = '0.6';
            emailElement.style.pointerEvents = 'none';
            
            const isCorrect = email.isPhishing === markedAsPhishing;
            
            if (!isCorrect) {
                gameState.score -= email.penalty;
                const errorMsg = email.isPhishing 
                    ? `–ü—Ä–æ–ø—É—â–µ–Ω–æ —Ñ–∏—à–∏–Ω–≥–æ–≤–æ–µ –ø–∏—Å—å–º–æ: "${email.subject}"`
                    : `–û—à–∏–±–æ—á–Ω–æ –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ —Ñ–∏—à–∏–Ω–≥: "${email.subject}"`;
                
                gameState.errors.push({
                    stage: stage.title,
                    error: errorMsg,
                    penalty: email.penalty
                });
                
                emailElement.style.borderColor = '#f44336';
                showFeedback('‚ùå –û—à–∏–±–∫–∞', 
                    isCorrect ? '–ü—Ä–∞–≤–∏–ª—å–Ω–æ!' : 
                    `–ù–µ–≤–µ—Ä–Ω–æ! ${email.isPhishing ? '–≠—Ç–æ –±—ã–ª —Ñ–∏—à–∏–Ω–≥' : '–≠—Ç–æ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–µ –ø–∏—Å—å–º–æ'}. ${email.hints ? '–ü—Ä–∏–∑–Ω–∞–∫–∏: ' + email.hints.join(', ') : ''}`,
                    false
                );
            } else {
                emailElement.style.borderColor = '#4CAF50';
                showFeedback('‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ', '–í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ –ø–∏—Å—å–º–æ!', true);
            }
            
            updateScore();
            emailsChecked++;
            
            if (emailsChecked >= stage.emails.length) {
                setTimeout(() => {
                    emailsChecked = 0;
                    loadStage(gameState.currentStage + 1);
                }, 2000);
            }
        }

        // –†–µ–Ω–¥–µ—Ä —ç—Ç–∞–ø–∞ —Å–µ—Ç–∏
        function renderNetworkStage(stage) {
            const content = document.getElementById('gameContent');
            content.innerHTML = `
                <div class="stage-screen">
                    <div class="stage-title">
                        <span>${stage.icon}</span>
                        <span>${stage.title}</span>
                    </div>
                    <div class="stage-description">
                        ${stage.description}
                    </div>
                    <div class="hint">
                        üîç <strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:</strong> –≤—Å–µ –ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Å–µ—Ç–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º? 
                        –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –º–æ–≥—É—Ç –±—ã—Ç—å —Ç–æ—á–∫–∞–º–∏ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.
                    </div>
                    <div class="device-panel">
                        <h3 style="margin-bottom: 15px;">–ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:</h3>
                        ${stage.devices.map(device => `
                            <div class="device-item">
                                <div class="device-info">
                                    <div class="device-name">${device.name}</div>
                                    <div class="device-details">MAC: ${device.mac}</div>
                                </div>
                                <div>
                                    ${device.status === 'safe' ? 
                                        '<span class="device-status status-safe">–ë–µ–∑–æ–ø–∞—Å–Ω–æ</span>' : 
                                        '<span class="device-status status-suspicious">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</span>'}
                                    ${device.status === 'suspicious' ? 
                                        `<button class="btn btn-danger" style="margin-left: 10px;" onclick="blockDevice(${device.id})">
                                            üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                                        </button>` : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="buttons-row">
                        <button class="btn btn-primary" onclick="completeNetworkStage()">
                            –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É ‚Üí
                        </button>
                    </div>
                </div>
            `;
        }

        const blockedDevices = [];
        function blockDevice(deviceId) {
            blockedDevices.push(deviceId);
            const deviceElement = event.target.closest('.device-item');
            deviceElement.style.opacity = '0.5';
            deviceElement.querySelector('.device-status').textContent = '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ';
            deviceElement.querySelector('.device-status').className = 'device-status status-dangerous';
            event.target.remove();
            
            showFeedback('‚úì –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ –æ—Ç —Å–µ—Ç–∏', true);
        }

        function completeNetworkStage() {
            const stage = stages[gameState.currentStage];
            const suspiciousDevices = stage.devices.filter(d => !d.isLegit);
            
            suspiciousDevices.forEach(device => {
                if (!blockedDevices.includes(device.id)) {
                    gameState.score -= device.penalty;
                    gameState.errors.push({
                        stage: stage.title,
                        error: `–ù–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ${device.name}`,
                        penalty: device.penalty
                    });
                }
            });
            
            updateScore();
            loadStage(gameState.currentStage + 1);
        }

        // –†–µ–Ω–¥–µ—Ä —ç—Ç–∞–ø–∞ –æ–±–ª–∞–∫–∞
        function renderCloudStage(stage) {
            const content = document.getElementById('gameContent');
            content.innerHTML = `
                <div class="stage-screen">
                    <div class="stage-title">
                        <span>${stage.icon}</span>
                        <span>${stage.title}</span>
                    </div>
                    <div class="stage-description">
                        ${stage.description}
                    </div>
                    <div class="hint">
                        ‚ö†Ô∏è <strong>–í–Ω–∏–º–∞–Ω–∏–µ:</strong> –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã –ø—É–±–ª–∏—á–Ω–æ! 
                        –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–∂–¥–æ–º—É —Ñ–∞–π–ª—É.
                    </div>
                    <div class="cloud-files">
                        ${stage.files.map(file => `
                            <div class="file-item" data-file-id="${file.id}">
                                <div class="file-header">
                                    <div class="file-name">üìÑ ${file.name}</div>
                                    <div class="file-sharing">
                                        –î–æ—Å—Ç—É–ø: 
                                        <span class="sharing-badge sharing-${file.sharing}">
                                            ${file.sharing === 'public' ? 'üåê –ü—É–±–ª–∏—á–Ω—ã–π' : 
                                              file.sharing === 'team' ? 'üë• –ö–æ–º–∞–Ω–¥–∞' : 
                                              'üîí –ü—Ä–∏–≤–∞—Ç–Ω—ã–π'}
                                        </span>
                                    </div>
                                </div>
                                ${file.sharing === 'public' ? `
                                    <button class="btn btn-danger" onclick="changeFileAccess(${file.id})">
                                        üîí –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø
                                    </button>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                    <div class="buttons-row">
                        <button class="btn btn-primary" onclick="completeCloudStage()">
                            –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É ‚Üí
                        </button>
                    </div>
                </div>
            `;
        }

        const fixedFiles = [];
        function changeFileAccess(fileId) {
            fixedFiles.push(fileId);
            const fileElement = document.querySelector(`[data-file-id="${fileId}"]`);
            const badge = fileElement.querySelector('.sharing-badge');
            badge.className = 'sharing-badge sharing-private';
            badge.textContent = 'üîí –ü—Ä–∏–≤–∞—Ç–Ω—ã–π';
            event.target.remove();
            
            showFeedback('‚úì –î–æ—Å—Ç—É–ø –∏–∑–º–µ–Ω—ë–Ω', '–§–∞–π–ª —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤–∞–º', true);
        }

        function completeCloudStage() {
            const stage = stages[gameState.currentStage];
            const publicFiles = stage.files.filter(f => f.needsChange);
            
            publicFiles.forEach(file => {
                if (!fixedFiles.includes(file.id)) {
                    gameState.score -= file.penalty;
                    gameState.errors.push({
                        stage: stage.title,
                        error: `–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –æ—Å—Ç–∞–ª—Å—è –ø—É–±–ª–∏—á–Ω—ã–º: ${file.name}`,
                        penalty: file.penalty
                    });
                }
            });
            
            updateScore();
            loadStage(gameState.currentStage + 1);
        }

        // –ó–∞–≤–µ—Ä—à–∏—Ç—å —ç—Ç–∞–ø —Å –∑–∞–¥–∞—á–∞–º–∏
        function completeStage() {
            const stage = stages[gameState.currentStage];
            
            stage.tasks.forEach(task => {
                const isCompleted = gameState.completedTasks.includes(task.id);
                
                // –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
                if (task.correct && !isCompleted) {
                    gameState.score -= task.penalty;
                    gameState.errors.push({
                        stage: stage.title,
                        error: `–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: ${task.text}`,
                        penalty: task.penalty
                    });
                }
                
                // –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, –Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
                if (!task.correct && isCompleted) {
                    gameState.score -= task.penalty;
                    gameState.errors.push({
                        stage: stage.title,
                        error: `–û—à–∏–±–æ—á–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: ${task.text}`,
                        penalty: task.penalty
                    });
                }
            });
            
            gameState.completedTasks = [];
            updateScore();
            loadStage(gameState.currentStage + 1);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É
        function showHint() {
            const stage = stages[gameState.currentStage];
            if (!stage.tasks) return;
            
            gameState.score -= 5;
            gameState.hintsUsed++;
            updateScore();
            
            const hints = stage.tasks
                .filter(task => task.hint)
                .map(task => `‚Ä¢ ${task.text}: ${task.hint}`)
                .join('<br>');
            
            showFeedback('üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞', hints, true);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç—á—ë—Ç
        function showReport() {
            const elapsedTime = Math.floor((Date.now() - gameState.startTime) / 1000);
            const minutes = Math.floor(elapsedTime / 60);
            const seconds = elapsedTime % 60;
            
            const scorePercent = Math.max(0, gameState.score);
            let scoreClass = 'score-good';
            let scoreText = '–û—Ç–ª–∏—á–Ω–æ!';
            
            if (scorePercent < 60) {
                scoreClass = 'score-bad';
                scoreText = '–¢—Ä–µ–±—É–µ—Ç—Å—è —É–ª—É—á—à–µ–Ω–∏–µ';
            } else if (scorePercent < 80) {
                scoreClass = 'score-medium';
                scoreText = '–•–æ—Ä–æ—à–æ';
            }
            
            const content = document.getElementById('gameContent');
            content.innerHTML = `
                <div class="report-screen">
                    <div class="report-title">üìä –û—Ç—á—ë—Ç –æ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</div>
                    
                    <div class="score-circle ${scoreClass}">
                        ${scorePercent}%
                    </div>
                    
                    <h3 style="color: #667eea; margin-bottom: 20px;">${scoreText}</h3>
                    
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 20px 0;">
                        <strong>–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:</strong> ${minutes}:${seconds.toString().padStart(2, '0')}<br>
                        <strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø–æ–¥—Å–∫–∞–∑–æ–∫:</strong> ${gameState.hintsUsed}<br>
                        <strong>–í—Å–µ–≥–æ –æ—à–∏–±–æ–∫:</strong> ${gameState.errors.length}
                    </div>
                    
                    ${gameState.errors.length > 0 ? `
                        <div class="errors-list">
                            <h3 style="color: #f44336; margin-bottom: 15px;">‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏:</h3>
                            ${gameState.errors.map(error => `
                                <div class="error-item">
                                    <strong>${error.stage}</strong><br>
                                    ${error.error} <span style="color: #f44336;">(-${error.penalty} –æ—á–∫–æ–≤)</span>
                                </div>
                            `).join('')}
                        </div>
                    ` : '<div style="color: #4CAF50; font-size: 1.2em;">‚úì –û—à–∏–±–æ–∫ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ!</div>'}
                    
                    <div class="recommendations">
                        <h3 style="color: #2196F3; margin-bottom: 15px;">üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</h3>
                        ${generateRecommendations()}
                    </div>
                    
                    <div class="buttons-row">
                        <button class="btn btn-primary" onclick="location.reload()">
                            üîÑ –ü—Ä–æ–π—Ç–∏ —Å–Ω–æ–≤–∞
                        </button>
                        <button class="btn btn-success" onclick="downloadReport()">
                            üì• –°–∫–∞—á–∞—Ç—å –æ—Ç—á—ë—Ç
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('currentStage').textContent = '–ó–∞–≤–µ—Ä—à–µ–Ω–æ';
            updateProgress();
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
        function generateRecommendations() {
            const recommendations = [];
            const errorStages = [...new Set(gameState.errors.map(e => e.stage))];
            
            if (errorStages.includes('üíª –†–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ')) {
                recommendations.push('–í—Å–µ–≥–¥–∞ –±–ª–æ–∫–∏—Ä—É–π—Ç–µ —Ä–∞–±–æ—á—É—é —Å—Ç–∞–Ω—Ü–∏—é –ø–µ—Ä–µ–¥ —É—Ö–æ–¥–æ–º (Win+L)');
                recommendations.push('–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏');
            }
            
            if (errorStages.includes('üîë –ü–∞—Ä–æ–ª–∏ –∏ —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏')) {
                recommendations.push('–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥—ë–∂–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π');
                recommendations.push('–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é');
            }
            
            if (errorStages.includes('üìß –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞')) {
                recommendations.push('–ë—É–¥—å—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã –∫ –ø–∏—Å—å–º–∞–º —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏ –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö');
                recommendations.push('–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –≤–ª–æ–∂–µ–Ω–∏–π');
            }
            
            if (errorStages.includes('üåê –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å–µ—Ç—å')) {
                recommendations.push('–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤');
                recommendations.push('–ë–ª–æ–∫–∏—Ä—É–π—Ç–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ');
            }
            
            if (errorStages.includes('‚òÅÔ∏è –û–±–ª–∞—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã')) {
                recommendations.push('–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–µ–ª–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—É–±–ª–∏—á–Ω—ã–º–∏');
                recommendations.push('–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±–ª–∞—á–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º');
            }
            
            if (errorStages.includes('üë• –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏')) {
                recommendations.push('–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –≤–∏–¥–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è');
                recommendations.push('–ù–µ –ø—Ä–∏–Ω–∏–º–∞–π—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤');
            }
            
            if (recommendations.length === 0) {
                recommendations.push('–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–æ–±–ª—é–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏');
                recommendations.push('–†–µ–≥—É–ª—è—Ä–Ω–æ –ø–æ–≤—Ç–æ—Ä—è–π—Ç–µ —Ç—Ä–µ–Ω–∏–Ω–≥–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏');
            }
            
            return recommendations.map(r => `
                <div class="recommendation-item">
                    ${r}
                </div>
            `).join('');
        }

        // –°–∫–∞—á–∞—Ç—å –æ—Ç—á—ë—Ç
        function downloadReport() {
            const scorePercent = Math.max(0, gameState.score);
            const elapsedTime = Math.floor((Date.now() - gameState.startTime) / 1000);
            const minutes = Math.floor(elapsedTime / 60);
            const seconds = elapsedTime % 60;
            
            let report = `–û–¢–ß–Å–¢ –û –ö–ò–ë–ï–†–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
================================

–û—Ü–µ–Ω–∫–∞ –∫–∏–±–µ—Ä–≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏: ${scorePercent}%
–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è: ${minutes}:${seconds.toString().padStart(2, '0')}
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø–æ–¥—Å–∫–∞–∑–æ–∫: ${gameState.hintsUsed}
–í—Å–µ–≥–æ –æ—à–∏–±–æ–∫: ${gameState.errors.length}

–û–ë–ù–ê–†–£–ñ–ï–ù–ù–´–ï –û–®–ò–ë–ö–ò:
`;
            
            gameState.errors.forEach(error => {
                report += `\n[${error.stage}]\n${error.error} (-${error.penalty} –æ—á–∫–æ–≤)\n`;
            });
            
            report += `\n–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:\n`;
            const recs = generateRecommendations().match(/<div class="recommendation-item">\s*(.*?)\s*<\/div>/g);
            if (recs) {
                recs.forEach(rec => {
                    const text = rec.replace(/<[^>]*>/g, '').trim();
                    report += `\n‚Ä¢ ${text}`;
                });
            }
            
            const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'cybersecurity_report.txt';
            link.click();
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
        function updateProgress() {
            const progress = ((gameState.currentStage + 1) / stages.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        // –û–±–Ω–æ–≤–∏—Ç—å —Å—á—ë—Ç
        function updateScore() {
            document.getElementById('scoreDisplay').textContent = `–û—á–∫–∏: ${Math.max(0, gameState.score)}`;
        }

        // –¢–∞–π–º–µ—Ä
        function startTimer() {
            setInterval(() => {
                const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('timer').textContent = 
                    `–í—Ä–µ–º—è: ${minutes}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
        function showFeedback(title, text, isPositive) {
            const modal = document.getElementById('feedbackModal');
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalText').innerHTML = text;
            modal.classList.add('active');
        }

        function closeFeedbackModal() {
            document.getElementById('feedbackModal').classList.remove('active');
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        window.onload = initGame;
    </script>
</body>
</html>
